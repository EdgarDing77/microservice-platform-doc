# 接口说明

### 密码模式

请求URL：`http://localhost:9900/api-uaa/oauth/token?grant_type=password&username={username}&password={password}&account_type={account_type}`

请求方式：POST

请求头：

| 参数名        | 参数值                          | 是否必须 | 类型   | 说明                                                         |
| :------------ | :------------------------------ | :------- | :----- | :----------------------------------------------------------- |
| Authorization | Basic {clientId}:{clientSecret} | 是       | string | {clientId}:{clientSecret} 的值必需使用base64加密，clientId为应用id，clientSecret为应用密钥 |

请求参数：

| 参数名       | 参数值   | 是否必须 | 类型   | 说明     |
| :----------- | :------- | :------- | :----- | :------- |
| grant_type   | password | 是       | string | 授权类型 |
| username     |          | 是       | string | 用户名   |
| password     |          | 是       | string | 密码     |
| account_type |          | 否       | string | 用户类型 |

正确时返回：

```json
{
    "resp_code": 200,
    "resp_msg": "ok",
    "datas": {
        "access_token": "d1186597-aeb4-4214-b176-08ec09b1f1ed",
        "token_type": "bearer",
        "refresh_token": "37fd65d8-f017-4b5a-9975-22b3067fb30b",
        "expires_in": 3599,
        "scope": "all",
        "account_type": "admin"
    }
}
```

### 授权码模式

#### 获取code

请求参数：`http://localhost:9900/api-uaa/oauth/authorize?client_id={client_id}&redirect_uri={redirect_uri}&response_type=code&scope={scope}&state={state}`

请求方式：GET

请求参数：

| 参数名        | 参数值 | 是否必须 | 类型   | 说明                                                         |
| :------------ | :----- | :------- | :----- | :----------------------------------------------------------- |
| client_id     |        | 是       | string | 应用id                                                       |
| redirect_uri  |        | 是       | string | 回跳地址(必需和应用配置里面的地址一致)                       |
| response_type | code   | 是       | string | 返回类型                                                     |
| scope         |        | 否       | string | 授权范围                                                     |
| state         |        | 否       | string | 表示客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值 |

**成功后跳转回调地址redirect_uri并带上code参数**

#### 通过code获取token

请求URL：`http://localhost:9900/api-uaa/oauth/token?code={code}&grant_type=authorization_code&redirect_uri={redirect_uri}&scope={scope}`

请求方式：POST

请求头：

| 数名          | 参数值                          | 是否必须 | 类型   | 说明                                                         |
| :------------ | :------------------------------ | :------- | :----- | :----------------------------------------------------------- |
| Authorization | Basic {clientId}:{clientSecret} | 是       | string | {clientId}:{clientSecret} 的值必需使用base64加密，clientId为应用id，clientSecret为应用密钥 |

请求参数：

| 参数名       | 参数值             | 是否必须 | 类型   | 说明                       |
| :----------- | :----------------- | :------- | :----- | :------------------------- |
| grant_type   | authorization_code | 是       | string | 授权类型                   |
| code         |                    | 是       | string | 第一步获取的授权码         |
| redirect_uri |                    | 是       | string | 回调地址，必需与第一步一致 |
| scope        |                    | 否       | string | 授权范围                   |

正确时返回：

```json
{
    "access_token": "956d590b-5ac0-48d2-89d7-3eca118411b9",
    "token_type": "bearer",
    "refresh_token": "710501ad-6342-4df5-853f-84c240712a85",
    "expires_in": 3599,
    "scope": "all"
}
```

### 隐式模式

请求方式：GET

请求URL：`http://localhost:9900/api-uaa/oauth/authorize?client_id={client_id}&redirect_uri={redirect_uri}&response_type=token&scope={scope}`

请求参数：

| 参数名        | 参数值 | 是否必须 | 类型   | 说明     |
| :------------ | :----- | :------- | :----- | :------- |
| client_id     |        | 是       | string | 应用id   |
| redirect_uri  |        | 是       | string | 回调地址 |
| response_type | token  | 是       | string | 返回类型 |
| scope         |        | 否       | string | 授权范围 |

### 客户端模式授权

请求URL：`http://localhost:9900/api-uaa/oauth/token?grant_type=client_credentials`

请求方式：POST

请求头：

| 参数名        | 参数值                          | 是否必须 | 类型   | 说明                                                         |
| :------------ | :------------------------------ | :------- | :----- | :----------------------------------------------------------- |
| Authorization | Basic {clientId}:{clientSecret} | 是       | string | {clientId}:{clientSecret} 的值必需使用base64加密，clientId为应用id，clientSecret为应用密钥 |

请求参数：

| 参数名     | 参数值             | 是否必须 | 类型   | 说明     |
| :--------- | :----------------- | :------- | :----- | :------- |
| grant_type | client_credentials | 是       | string | 授权类型 |

正确时返回：

```json
{
    "resp_code": 200,
    "resp_msg": "ok",
    "datas": {
        "access_token": "d1186597-aeb4-4214-b176-08ec09b1f1ed",
        "token_type": "bearer",
        "refresh_token": "37fd65d8-f017-4b5a-9975-22b3067fb30b",
        "expires_in": 3599,
        "scope": "all"
    }
}
```

