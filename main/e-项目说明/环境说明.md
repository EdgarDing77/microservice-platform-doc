# 环境说明

## Http请求头

```
x-trace-id-header # 日志追踪链路头
x-user-id-header # 用户Id
x-user-header # 用户名username
x-tenant-header # 租户id (String)
x-role-header # 角色
x-account-type-header # 账号类型
```

访问后端API需要带上token：

```api
# 放入Header方式
Authorization:Bearer xxx

# 放入参数方式
http://localhost:9900/api-user/users?access_token=xxx
```

## 配置文件

Swagger配置：

```yml
djj:
	swagger:
		enable: true # 是否启用(true)
    title: 认证中心 # “”
    description: 认证中心接口文档 # “”
    version: 1.0.0 # “”
    license:
    licenseUrl:
    termsOfServiceUrl: # 服务条款
    contact:
    	name:
    	url:
    	email:
    basePackage: top.edgarding.uaa.controller # “” swagger会解析的包路径
    basePath: 
    excludePath: 
djj:
	swagger-agg: # swagger聚合配置
		apiDocsPath: "/v2/api-docs"
		swaggerVersion: 2.0.0
		generateRoutes:
			-
    ignoreRoutes:
    	-
```

分布式锁类型：

```yml
djj:
	lock:
		type: redis 
```

统一缓存管理cacheManager：

```yml
djj:
  cache-manager:
    configs:
      - key: menu
        second: 300
      - key: user
        second: 1800
```

loadbalancer配置：

```yml
djj:
	rest-template:
		maxTotal: 200 # 最大链接数
		maxPreRoute: 50 # 同路由最大并发数
		readTimeout: 30000 # 读取超时时间 单位ms
		connectTimeout: 10000 # 链接超时时间 单位ms
```

审计日志配置：

```yml
djj:
	audit-log:
		enable: false # 默认关闭
		type: logger # db ｜ logger
```

日志链路追踪：

```yaml
djj:
	trace-log:
		enable: false # 默认为false
```

多租户配置：

```yml
djj:
	tenant:
		enable: false # 默认为false
		ignoreTables: # 配置不进行多租户隔离的表名
			- sys_user
			- sys_role_user
			- sys_role_menu
```

mybatis-plus自动填充配置：

```yml
djj:
	mybatis-plus:
		enable: true # 默认为true
		enableInsertFill: true # 启用插入填充 这里指createTime
		enableUpdateFill: true # 启用更新填充 这里指updateTime
```

认证token方式：

```yml
djj:
	oauth2:
		token:
			store:
				type: authJwt # redis, db, authJwt | resJwt(除认证服务外其他服务)
```

security配置：

```yaml
djj:
	security:
		auth:
			httpUrls: # 这里配置需要认证的URL，优先级大雨ignore.httpUrls
			renew: # token自动续签配置
				enable: false # 默认为false
				includeClientIds: # 白名单，配置自动续签的id，不配置默认所有应用生效
					-
					-
        exclusiveClientIds: # 黑明单，配置不需要自动续签的AppId
        	-
        	-
        timeRatio: 0.5 # 默认0.5 续签时间比例，当前剩余时间小于过期总时长的50%则续签
      urlPermission:
      	enable: false # 默认为false
      	includeClientIds: # 白名单，需要url认证
      	exclusiveClientIds: # 黑名单，不需要url级认证
      	ignoreUrls: # 配置只进行登录认证，而无需url级认证的API
		ignore:
			httpUrls: # 配置需要放权的URL白名单
		code: # 验证码配置
			ignoreClientCode: # 配置认证时不需要验证码的clientId
				-
				-
```

动态路由配置：

```yml
djj:
 gateway:
    dynamicRoute:
      enable: true # 动态网关
      type: nacos

```

